<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
    <head>
        <meta content="text/html; charset=utf-8" http-equiv="content-type">
        <title>Práctica 1</title>
        <link rel="stylesheet" href="s.css">
    </head>
    <body>
        <div class="cuerpo">
<h1>Práctica 1</h1>

<h2>Apartado a</h2>

<p>Fichero de interfaces <code>/etc/network/interfaces</code>:</p>

<pre><code># This file describes the network interfaces available on your system
# and how to activate them. For more information, see interfaces(5).

# The loopback network interface
auto lo
iface lo inet loopback

# The primary network interface
allow-hotplug eth0
#NetworkManager#iface eth0 inet dhcp

auto eth0
iface eth0 inet static
    address 10.10.102.185
    netmask 255.255.255.0
    gateway 10.10.102.5

auto eth1
iface eth1 inet static
    address 10.10.150.185
    netmask 255.255.255.0
</code></pre>

<p>Fichero de hosts <code>/etc/hosts</code>:</p>

<pre><code>127.0.0.1   localhost
127.0.1.1   debian

# The following lines are desirable for IPv6 capable hosts
::1     ip6-localhost ip6-loopback
fe00::0 ip6-localnet
ff00::0 ip6-mcastprefix
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
</code></pre>

<p>Fichero <code>/etc/resolv.conf</code>:</p>

<pre><code># Generated by NetworkManager
domain waislado.cc.fic.udc.es
search waislado.cc.fic.udc.es
nameserver 10.10.102.27
</code></pre>

<p>Fichero <code>/etc/nsswitch.conf</code>:</p>

<pre><code># /etc/nsswitch.conf
#
# Example configuration of GNU Name Service Switch functionality.
# If you have the `glibc-doc-reference' and `info' packages installed, try:
# `info libc "Name Service Switch"' for information about this file.

passwd:         compat
group:          compat
shadow:         compat

hosts:          files mdns4_minimal [NOTFOUND=return] dns mdns4
networks:       files

protocols:      db files
services:       db files
ethers:         db files
rpc:            db files

netgroup:       nis
</code></pre>

<p>Fichero <code>/etc/apt/sources.list</code>:</p>

<pre><code># deb cdrom:[Debian GNU/Linux 6.0.5 _Squeeze_ - Official Multi-architecture amd64/i386 NETINST #1 20120512-20:52]/ squeeze main

#deb cdrom:[Debian GNU/Linux 6.0.5 _Squeeze_ - Official Multi-architecture amd64/i386 NETINST #1 20120512-20:52]/ squeeze main

deb http://ftp.es.debian.org/debian/ squeeze main
deb-src http://ftp.es.debian.org/debian/ squeeze main

deb http://security.debian.org/ squeeze/updates main
deb-src http://security.debian.org/ squeeze/updates main

# squeeze-updates, previously known as 'volatile'
#deb http://ftp.es.debian.org/debian/ squeeze-updates main
#deb-src http://ftp.es.debian.org/debian/ squeeze-updates main
</code></pre>

<p>Fichero de <a href="https://wiki.debian.org/RunLevel">runlevel</a> <code>/etc/inittab</code>, como se puede apreciar, tiene nivel 2 por defecto:</p>

<pre><code># /etc/inittab: init(8) configuration.
# $Id: inittab,v 1.91 2002/01/25 13:35:21 miquels Exp $

# The default runlevel.
id:2:initdefault:

# Boot-time system configuration/initialization script.
# This is run first except when booting in emergency (-b) mode.
si::sysinit:/etc/init.d/rcS

# What to do in single-user mode.
~~:S:wait:/sbin/sulogin

# /etc/init.d executes the S and K scripts upon change
# of runlevel.
#
# Runlevel 0 is halt.
# Runlevel 1 is single-user.
# Runlevels 2-5 are multi-user.
# Runlevel 6 is reboot.

l0:0:wait:/etc/init.d/rc 0
l1:1:wait:/etc/init.d/rc 1
l2:2:wait:/etc/init.d/rc 2
l3:3:wait:/etc/init.d/rc 3
l4:4:wait:/etc/init.d/rc 4
l5:5:wait:/etc/init.d/rc 5
l6:6:wait:/etc/init.d/rc 6
# Normally not reached, but fallthrough in case of emergency.
z6:6:respawn:/sbin/sulogin

# What to do when CTRL-ALT-DEL is pressed.
ca:12345:ctrlaltdel:/sbin/shutdown -t1 -a -r now

# Action on special keypress (ALT-UpArrow).
#kb::kbrequest:/bin/echo "Keyboard Request--edit /etc/inittab to let this work."

# What to do when the power fails/returns.
pf::powerwait:/etc/init.d/powerfail start
pn::powerfailnow:/etc/init.d/powerfail now
po::powerokwait:/etc/init.d/powerfail stop

# /sbin/getty invocations for the runlevels.
#
# The "id" field MUST be the same as the last
# characters of the device (after "tty").
#
# Format:
#  &lt;id&gt;:&lt;runlevels&gt;:&lt;action&gt;:&lt;process&gt;
#
# Note that on most Debian systems tty7 is used by the X Window System,
# so if you want to add more getty's go ahead but skip tty7 if you run X.
#
1:2345:respawn:/sbin/getty 38400 tty1
2:23:respawn:/sbin/getty 38400 tty2
3:23:respawn:/sbin/getty 38400 tty3
4:23:respawn:/sbin/getty 38400 tty4
5:23:respawn:/sbin/getty 38400 tty5
6:23:respawn:/sbin/getty 38400 tty6

# Example how to put a getty on a serial line (for a terminal)
#
#T0:23:respawn:/sbin/getty -L ttyS0 9600 vt100
#T1:23:respawn:/sbin/getty -L ttyS1 9600 vt100

# Example how to put a getty on a modem line.
#
#T3:23:respawn:/sbin/mgetty -x0 -s 57600 ttyS3
</code></pre>

<p>Aplicaciones al inicio <code>ls /etc/rc*.d/*</code></p>

<pre><code>/etc/rc0.d/K01alsa-utils@           /etc/rc4.d/S18anacron@
/etc/rc0.d/K01anacron@              /etc/rc4.d/S18atd@
/etc/rc0.d/K01atd@                  /etc/rc4.d/S18cron@
/etc/rc0.d/K01bluetooth@            /etc/rc4.d/S18dbus@
/etc/rc0.d/K01exim4@                /etc/rc4.d/S18exim4@
/etc/rc0.d/K01fuse@                 /etc/rc4.d/S18kerneloops@
/etc/rc0.d/K01gdm3@                 /etc/rc4.d/S18loadcpufreq@
/etc/rc0.d/K01kerneloops@           /etc/rc4.d/S18mpt-statusd@
/etc/rc0.d/K01mpt-statusd@          /etc/rc4.d/S19avahi-daemon@
/etc/rc0.d/K01network-manager@      /etc/rc4.d/S19bluetooth@
/etc/rc0.d/K01saned@                /etc/rc4.d/S19cpufrequtils@
/etc/rc0.d/K01unattended-upgrades@  /etc/rc4.d/S19network-manager@
/etc/rc0.d/K01urandom@              /etc/rc4.d/S19ssh@
/etc/rc0.d/K02avahi-daemon@         /etc/rc4.d/S20cups@
/etc/rc0.d/K03sendsigs@             /etc/rc4.d/S20gdm3@
/etc/rc0.d/K04rsyslog@              /etc/rc4.d/S20saned@
/etc/rc0.d/K05umountnfs.sh@         /etc/rc4.d/S21bootlogs@
/etc/rc0.d/K06nfs-common@           /etc/rc4.d/S22rc.local@
/etc/rc0.d/K06portmap@              /etc/rc4.d/S22rmnologin@
/etc/rc0.d/K07hwclock.sh@           /etc/rc4.d/S22stop-bootlogd@
/etc/rc0.d/K07networking@           /etc/rc5.d/README
/etc/rc0.d/K08ifupdown@             /etc/rc5.d/S14portmap@
/etc/rc0.d/K09umountfs@             /etc/rc5.d/S15nfs-common@
/etc/rc0.d/K10umountroot@           /etc/rc5.d/S17binfmt-support@
/etc/rc0.d/K11halt@                 /etc/rc5.d/S17fancontrol@
/etc/rc0.d/README                   /etc/rc5.d/S17rsyslog@
/etc/rc1.d/K01alsa-utils@           /etc/rc5.d/S17sudo@
/etc/rc1.d/K01anacron@              /etc/rc5.d/S18acpid@
/etc/rc1.d/K01atd@                  /etc/rc5.d/S18anacron@
/etc/rc1.d/K01bluetooth@            /etc/rc5.d/S18atd@
/etc/rc1.d/K01cups@                 /etc/rc5.d/S18cron@
/etc/rc1.d/K01exim4@                /etc/rc5.d/S18dbus@
/etc/rc1.d/K01gdm3@                 /etc/rc5.d/S18exim4@
/etc/rc1.d/K01kerneloops@           /etc/rc5.d/S18kerneloops@
/etc/rc1.d/K01mpt-statusd@          /etc/rc5.d/S18loadcpufreq@
/etc/rc1.d/K01network-manager@      /etc/rc5.d/S18mpt-statusd@
/etc/rc1.d/K01saned@                /etc/rc5.d/S19avahi-daemon@
/etc/rc1.d/K02avahi-daemon@         /etc/rc5.d/S19bluetooth@
/etc/rc1.d/K04rsyslog@              /etc/rc5.d/S19cpufrequtils@
/etc/rc1.d/K06nfs-common@           /etc/rc5.d/S19network-manager@
/etc/rc1.d/K06portmap@              /etc/rc5.d/S19ssh@
/etc/rc1.d/README                   /etc/rc5.d/S20cups@
/etc/rc1.d/S01killprocs@            /etc/rc5.d/S20gdm3@
/etc/rc1.d/S21bootlogs@             /etc/rc5.d/S20saned@
/etc/rc1.d/S22single@               /etc/rc5.d/S21bootlogs@
/etc/rc2.d/README                   /etc/rc5.d/S22rc.local@
/etc/rc2.d/S14portmap@              /etc/rc5.d/S22rmnologin@
/etc/rc2.d/S15nfs-common@           /etc/rc5.d/S22stop-bootlogd@
/etc/rc2.d/S17binfmt-support@       /etc/rc6.d/K01alsa-utils@
/etc/rc2.d/S17fancontrol@           /etc/rc6.d/K01anacron@
/etc/rc2.d/S17rsyslog@              /etc/rc6.d/K01atd@
/etc/rc2.d/S17sudo@                 /etc/rc6.d/K01bluetooth@
/etc/rc2.d/S18acpid@                /etc/rc6.d/K01exim4@
/etc/rc2.d/S18anacron@              /etc/rc6.d/K01fuse@
/etc/rc2.d/S18atd@                  /etc/rc6.d/K01gdm3@
/etc/rc2.d/S18cron@                 /etc/rc6.d/K01kerneloops@
/etc/rc2.d/S18dbus@                 /etc/rc6.d/K01mpt-statusd@
/etc/rc2.d/S18exim4@                /etc/rc6.d/K01network-manager@
/etc/rc2.d/S18kerneloops@           /etc/rc6.d/K01saned@
/etc/rc2.d/S18loadcpufreq@          /etc/rc6.d/K01unattended-upgrades@
/etc/rc2.d/S18mpt-statusd@          /etc/rc6.d/K01urandom@
/etc/rc2.d/S18ssa@                  /etc/rc6.d/K02avahi-daemon@
/etc/rc2.d/S19avahi-daemon@         /etc/rc6.d/K03sendsigs@
/etc/rc2.d/S19bluetooth@            /etc/rc6.d/K04rsyslog@
/etc/rc2.d/S19cpufrequtils@         /etc/rc6.d/K05umountnfs.sh@
/etc/rc2.d/S19network-manager@      /etc/rc6.d/K06nfs-common@
/etc/rc2.d/S19ssh@                  /etc/rc6.d/K06portmap@
/etc/rc2.d/S20cups@                 /etc/rc6.d/K07hwclock.sh@
/etc/rc2.d/S20gdm3@                 /etc/rc6.d/K07networking@
/etc/rc2.d/S20saned@                /etc/rc6.d/K08ifupdown@
/etc/rc2.d/S21bootlogs@             /etc/rc6.d/K09umountfs@
/etc/rc2.d/S22rc.local@             /etc/rc6.d/K10umountroot@
/etc/rc2.d/S22rmnologin@            /etc/rc6.d/K11reboot@
/etc/rc2.d/S22stop-bootlogd@        /etc/rc6.d/README
/etc/rc3.d/README                   /etc/rcS.d/README
/etc/rc3.d/S14portmap@              /etc/rcS.d/S01mountkernfs.sh@
/etc/rc3.d/S15nfs-common@           /etc/rcS.d/S02udev@
/etc/rc3.d/S17binfmt-support@       /etc/rcS.d/S03mountdevsubfs.sh@
/etc/rc3.d/S17fancontrol@           /etc/rcS.d/S04bootlogd@
/etc/rc3.d/S17rsyslog@              /etc/rcS.d/S05keyboard-setup@
/etc/rc3.d/S17sudo@                 /etc/rcS.d/S06hdparm@
/etc/rc3.d/S18acpid@                /etc/rcS.d/S06hostname.sh@
/etc/rc3.d/S18anacron@              /etc/rcS.d/S06hwclockfirst.sh@
/etc/rc3.d/S18atd@                  /etc/rcS.d/S07checkroot.sh@
/etc/rc3.d/S18cron@                 /etc/rcS.d/S08hwclock.sh@
/etc/rc3.d/S18dbus@                 /etc/rcS.d/S08ifupdown-clean@
/etc/rc3.d/S18exim4@                /etc/rcS.d/S08module-init-tools@
/etc/rc3.d/S18kerneloops@           /etc/rcS.d/S08mtab.sh@
/etc/rc3.d/S18loadcpufreq@          /etc/rcS.d/S09checkfs.sh@
/etc/rc3.d/S18mpt-statusd@          /etc/rcS.d/S10ifupdown@
/etc/rc3.d/S19avahi-daemon@         /etc/rcS.d/S10mountall.sh@
/etc/rc3.d/S19bluetooth@            /etc/rcS.d/S11mountall-bootclean.sh@
/etc/rc3.d/S19cpufrequtils@         /etc/rcS.d/S12mountoverflowtmp@
/etc/rc3.d/S19network-manager@      /etc/rcS.d/S13networking@
/etc/rc3.d/S19ssh@                  /etc/rcS.d/S13pppd-dns@
/etc/rc3.d/S20cups@                 /etc/rcS.d/S13procps@
/etc/rc3.d/S20gdm3@                 /etc/rcS.d/S13udev-mtab@
/etc/rc3.d/S20saned@                /etc/rcS.d/S13urandom@
/etc/rc3.d/S21bootlogs@             /etc/rcS.d/S13x11-common@
/etc/rc3.d/S22rc.local@             /etc/rcS.d/S14portmap@
/etc/rc3.d/S22rmnologin@            /etc/rcS.d/S15nfs-common@
/etc/rc3.d/S22stop-bootlogd@        /etc/rcS.d/S16mountnfs.sh@
/etc/rc4.d/README                   /etc/rcS.d/S17mountnfs-bootclean.sh@
/etc/rc4.d/S14portmap@              /etc/rcS.d/S18kbd@
/etc/rc4.d/S15nfs-common@           /etc/rcS.d/S19console-setup@
/etc/rc4.d/S17binfmt-support@       /etc/rcS.d/S20alsa-utils@
/etc/rc4.d/S17fancontrol@           /etc/rcS.d/S20bootmisc.sh@
/etc/rc4.d/S17rsyslog@              /etc/rcS.d/S20fuse@
/etc/rc4.d/S17sudo@                 /etc/rcS.d/S20lm-sensors@
/etc/rc4.d/S18acpid@                /etc/rcS.d/S21stop-bootlogd-single@
</code></pre>

<p>Instalar NX <code>sudo dpkg -i Descargas/*.deb</code>.</p>

<h2>Apartado b</h2>

<p>Configurar de tipo C:</p>

<pre><code>ifconfig eth1 192.168.1.44
</code></pre>

<p>O una en <code>10.10.150.0/24</code>:</p>

<pre><code>ifconfig eth1 10.10.150.185 netmask 255.255.255.0
</code></pre>

<p>La parte de <code>/etc/network/interfaces</code>:</p>

<pre><code>auto eth1
iface eth1 inet static
    address 10.10.150.185
    netmask 255.255.255.0
</code></pre>

<h2>Apartado c</h2>

<p>Las rutas con el comando <code>ip route</code>:</p>

<pre><code>10.10.102.0/24 dev eth0  proto kernel  scope link  src 10.10.102.185 
10.10.150.0/24 dev eth1  proto kernel  scope link  src 10.10.150.185 
default via 10.10.102.5 dev eth0
</code></pre>

<p>Añadimos una ruta estática, por ejemplo 10.10.88.0/24 por eth1 a 10.10.88.1:</p>

<pre><code>ip route add 10.10.88.0/24 via 10.10.88.1 dev eth1
</code></pre>

<h2>Apartado d</h2>

<p>Los servicios de red arrancados se pueden ver con netstat:</p>

<pre><code>root@debian:~# netstat -atnp
Active Internet connections (servers and established)
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name
tcp        0      0 0.0.0.0:111             0.0.0.0:*               LISTEN      893/portmap     
tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      1738/sshd       
tcp        0      0 127.0.0.1:631           0.0.0.0:*               LISTEN      1282/cupsd      
tcp        0      0 127.0.0.1:25            0.0.0.0:*               LISTEN      1540/exim4      
tcp        0      0 0.0.0.0:41735           0.0.0.0:*               LISTEN      905/rpc.statd   
tcp        0     48 10.10.102.185:22        10.20.65.183:47833      ESTABLISHED 3733/sshd: rodrigo 
tcp6       0      0 :::22                   :::*                    LISTEN      1738/sshd       
tcp6       0      0 ::1:631                 :::*                    LISTEN      1282/cupsd      
tcp6       0      0 ::1:25                  :::*                    LISTEN      1540/exim4
</code></pre>

<p>Hay algunos servicios que por ahora no hacen falta, como el servidor de correo <code>exim4</code>.</p>

<h2>Apartado e</h2>

<p>En la linea anterior vemos la conexión actual:</p>

<pre><code>tcp        0     48 10.10.102.185:22        10.20.65.183:47833      ESTABLISHED 3733/sshd: rodrigo
</code></pre>

<h2>Apartado f</h2>

<p>Con la herramienta <code>htop</code> se pueden observar todos los procesos en tiempo real, y ordenar por CPU, RAM... Para la monitorización de conexiones tcp, se puede usar la herramienta <code>tcptrack</code>, aunque en debian no está en los repositorios. Podemos reemplazarla por <code>netstat -cant</code>. Si queremos monitorizar mas información podemos usar <code>tcpdump</code>.</p>

<h2>Apartado g</h2>

<p>Para dejar sólo activo el ssh, podemos poner esta linea en <code>/etc/hosts.deny</code>:</p>

<pre><code>ALL EXCEPT sshd: ALL@ALL
</code></pre>

<h2>Apartado h</h2>

<p>Para sacar el syslog por una terminal, podemos poner en el fichero de configuración de rsyslog, <code>/etc/rsyslog.conf</code>:</p>

<pre><code>*.*     /dev/tty8
</code></pre>

<p>Sin embargo, para filtrar por ejemplo el servicio de ssh a un fichero:</p>

<pre><code>:programname, isequal, "sshd"   /var/log/sshd
</code></pre>

<h2>Apartado i</h2>

<p>Para configurar el tunel tun6to4 colocar la siguiente configuración en <code>/etc/network/interfaces</code>:</p>

<pre><code>auto tun6to4
iface tun6to4 inet6 v4tunnel
    address 2002:0a0a:66b9::1
    netmask 16              
    gateway ::192.88.99.1
    endpoint any
    local 10.10.102.185
</code></pre>

<p>Finalmente podemos hacer un ping ipv6 a cualquier máquina con el comando <code>ipv6</code>:</p>

<pre><code>$ ping6 2002:0a0a:66b6::1

PING 2002:0a0a:66b6::1(2002:a0a:66b6::1) 56 data bytes
64 bytes from 2002:a0a:66b6::1: icmp_seq=1 ttl=64 time=0.337 ms
64 bytes from 2002:a0a:66b6::1: icmp_seq=2 ttl=64 time=0.382 ms
64 bytes from 2002:a0a:66b6::1: icmp_seq=3 ttl=64 time=0.351 ms
^C
--- 2002:0a0a:66b6::1 ping statistics ---
3 packets transmitted, 3 received, 0% packet loss, time 1999ms
rtt min/avg/max/mdev = 0.337/0.356/0.382/0.028 ms
</code></pre>

<hr />

<h1>Práctica 2</h1>
        </div>
    </body>
</html>
